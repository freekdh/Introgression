\documentclass[a4paper,10pt]{article}
\usepackage{geometry}
\usepackage{graphicx}
\usepackage{amsmath}
\geometry{margin=0.8in}
\begin{document}
 
\section*{Introduction}

Long term environmental changes such as \textit{global warming} pose a major challenge to population survival \cite{parmesan2006ecological} \cite{hughes2000biological}. Weather populations will survive these changes depends on the strength of selection relative to their adaptive capacity as determined by demographics and availability of genetic variation \cite{lynch1993evolution} \cite{gomulkiewicz1995does} \cite{orr2008population}. Scenarios where evolution reverses demographic decline and so prevents otherwise inevitable extinction have been termed evolutionary rescue (ER). 

The probability of ER decreases with stress intensity and increases with initial population size and with genetic variation available to fuel adaptation to new conditions (for a review see \cite{bell2008adaptation}). 

Generally speaking, adaptive genetic variants are thought to predominantly originate from mutations and standing genetic variation. Another potential source are genetic variants from closely related sisterspecies that can enter the gene pool through introgressive hybridization. Introgression differs from gene flow, because it refers to genetic exchange between species rather than between populations of the same species. 

The potential role and importance of hybridization (i.e. the crossing of different species or populations) as a conservation management tool for evolutionary rescue is currently being debated. Hybrid back-crossing with one or both parental lineages (i.e. introgressive hybridization) can increase adaptive potential by introducing genetic variation through gene flow between otherwise distrinct populations.
	
However, introgressive hybridization (IH) can also lead to demographic swamping or genetic swamping, resulting in loss of the target lineage. Demographic swamping occurs when wasted reproductive efforts of the parental populations causes reduced fitness in the hybrid offspring (outbreeding depression) \cite{wolf2001predicting}. Consequently, population growth rates decline below replacement rates, hastening extinction. Genetic swamping occurs when the hybrids are significantly more fit than either parental population (outbreeding enhancement or hybrid vigor). As a result, gene flow carries undesirable alleles into the endangered population, which leads to extinction of the pure parental genome \cite{woodruff1987fifty} \cite{allendorf2001problems}. 

Empirical and theoretical results are inconclusive as to what determines the outcome of hybridization events. A literature review by Todesco et al. (2016) indicates that genetic and demographic swamping are more common outcomes of introgressive hybridization than genetic rescue \cite{todesco2016hybridization}. Although examples of extinction and displacement via hybridization have been documented, there are also instances in which the parental genome has remained relatively intact despite long histories of association and possible interbreeding, along with cases of stable hybrid zone formation \cite{vila2003rescue} \cite{madsen2004novel}. One possible reason for genetic rescue appearing as an uncommon outcome of hybridization studies is the ascertainment bias of the study since they included 'extinction' but not 'rescue' as their search terms. Unfortunately, there is little guidance as to when and how much hybridization might be useful.
	
Mathematical models can help to evaluate the relative risks of demographic and genetic swamping and can then be used to guide conservation approaches for evolutionary rescue of wild populations \cite{aitken2013assisted} \cite{baskett2011introgressive}. Theoretical models are especially useful where random experimentation poses a high extinction risk to the population. However, due to the unpredictable and potentially damaging effects of IH, its use as a conservation management tool remains controversial nowadays. For conservation purposes we need to know the long-term effects of hybridization and yet very little is known about what happens beyond the F2 or first back-cross generations. Here, we present a model with the aim to fill this gap by comparing the long term risks of genetic and demographic swamping relative to genetic rescue. Our model can be interpreted as a reference model for genome rescue by hybridization and can be used to assess the optimal number of parental individuals that should be introduced to minimize genetic- and demographic swamping and thus maximize the potential for evolutionary rescue.
 
\section*{Model description}

We begin by describing our evolutionary rescue model for introgression and show under which conditions introgression (genetic swamping) is minimized. We then continue to focus on the probability of rescue using a branching process analysis and show that a trade-off exists between evolutionary rescue and maintaining genetic purity. Simulations are used to expand on our analytical results by relaxing some of its assumptions.

\subsection*{Evolutionary model}
Consider a haploid population with two distinct types (wildtype and beneficial type) in which adaptation is determined by a single large effect gene ($i$). Furthermore, consider an infinite number of freely recombining marker loci to quantify genome-wide introgression. The individuals in the population mate at random without mutation, migration or any population structure. At each locus two alleles can segregate, denoted ($0,1$). Time is discrete and measured in generations.

At time $t=0$, a population of size $N_w(0)$ made up entirely of wiltype individuals experiences a sudden environmental change. Individuals go through the following lifecycle each generation: 'Census', 'Selection' and 'Reproduction'. Selection occurs during the haploid stage and is modeled as a viability type of selection. The wiltype allele has constant absolute fitness $W_w<1$ in the new environment, causing the number of wiltype individuals to decrease geometrically through time. A beneficial allele with absolute fitness $W_b$ is introduced at time $t=\tau > 0$ in $N_b(\tau)$ copies. Evolutionary rescue, if it occurs, involves an increase in frequency of the beneficial allele before the population goes extinct. Any allele that can lead to evolutionary rescue must enjoy an absolute fitness greater than one. 

We approximate the dynamics of the beneficial allele with an exponential function instead of a density dependent growth model. Eventually the beneficial allele will rise to a point where density dependence would alter the dynamics, but we assume that this occurs long after the fate of the beneficial allele is decided. Consequently, the temporal dynamics of each type can be approximated by the following dynamical system:
    
\begin{equation}
\begin{array}{l}
N_w[t+1] = W_w N_w[t] \\
N_b[t+1] = W_b N_b[t]
\end{array}
\end{equation}

with $t \in [0,\inf) $ and $N_w$ \& $N_b$ represent the number of wildtype or beneficial alleles respectively. Selection for the beneficial type $s = \frac{W_b}{W_w}-1$ (see Appendix) will be constant.

While it is known that hybridization often negatively influences fitness (outbreeding depression), we assume constant fitness for mathematical convenience. We expand on the analytical model with simulations that include fitness effects of hybridization.

During the other part of the life-cycle, individuals reproduce by forming diploid pairs which immediately undergo meiosis resulting in 2 haploid spores. During this process, random mating and recombination lead to introgression between the wildtype and beneficial type. To quantify the amount of introgression that occurs between both types, we assume that each individual carries an effectively infinite number of neutral loci which are initialized (at t=0) with type-specific alleles. Let $F_R[t]$ and $F_I[t]$ be the fractions of wildtype alleles at time $t$ that descend from the wildtype and beneficial type at $t=0$, respectively. Assuming genes segregate in a Mendelian fashion and individuals mate at random, the change of $F_R[t]$ and $F_I[t]$ per generation can be described by the following dynamical system: 
	\begin{equation}
    \begin{array}{l}
	F_w[t+1] = \overbrace{\frac{1}{2} (F_w[t]+F_b[t]) p_b[t+1]}^\text{$w$ x $b$}  + \overbrace{F_w[t] (1-p_b[t+1])}^\text{$w$ x $w$}
	 \\ \\
	F_b[t+1]  = \overbrace{\frac{1}{2} (F_w[t]+F_b[t]) (1-p_b[t+1])}^\text{$b$ x $w$} 
	+ \overbrace{F_b[t] p_b[t+1]}^\text{$b$ x $b$}
	\end{array}
	\end{equation}, 
where $p_b[t] = \frac{N_b[t]}{N_b[t]+N_w[t]}$ and with initial values $F_b[0]=0$ and $F_w[0]=1$. Note that because we assume an infinite number of neutral loci in our model, there is no variance in $F$ so it can be modeled as a deterministic variable: $\lim_{n \rightarrow \infty} E[\frac{\text{Binomial}[n,p]}{n}] = p$ and $\lim_{n \rightarrow \infty} Var[\frac{\text{Binomial}[n,p]}{n}] = 0 $. For a [$w$ x $w$] and a [$b$ x $b$] interaction, $p = F_w$ and $p = F_b$ respectively. However, for [$w$ x $b$], the probability of sampling from either parent becomes $p = \frac{1}{2} (F_w + F_b)$. $F_w$ and $F_b$ represent a uniform probability of finding a wildtype allele per locus across the genome. Implicit in these assumptions is a recombination rate of $0.5$, or the Bernoulli sampling trials per locus would not be independent and we could not use a binomial to approximate the mating between two haploid cells (see Appendix).

We can solve the system of differential equations in (2) by recognizing that $\text{dif}[t]=F_w[t]-F_b[t] = 2^{-t}$. The recursion equation for $F_b[t]$ becomes:

\begin{equation}
    F_b[t] = \sum_{i=1}^t 2^{-i} (1-p_b[i])
\end{equation}

This solution indicates that $F_b[t]$ is a weighted average of the frequencies of the beneficial type in each generation. The first 6 generations determine 99\% of the eventual introgression. If in these first 6 generations, $p_b[t]$ remains small, the amount of introgression is minimized ($F_b$ is maximized). This can be achieved by having an initial $p_b[0] \ll 1$, or a tiny selection differential $s \ll 1$.

When $N_w$ falls below $N_{c}$, we assume that it will be lost due to demographic stochasticity. 

\begin{equation}
    t_c = \frac{\log [\frac{N_c}{N_w[0]}]}{\log [W_w]}
\end{equation}



\subsection*{Trade-off evolutionary rescue and genetic purity}

The fixation probability, $P[t]$, of a single copy of the beneficial allele is measured before selection in generation $t$. Reproduction then occurs such that the number of offspring alleles expected from a beneficial allele is Poisson distributed with mean $1+s_b$. The probability of eventual fixation of $k$ independent copies of the beneficial mutation in the next generation is given by:

\begin{equation}
\begin{array}{l}
1-P_k[t]=\sum_{j=0}^{\infty} e^{-(1+s_b)}\frac{(1+s_b)^j}{j!}(1-P_1[t+1])^j\\
1-P_k[t]=e^{-(1+s_b)P_1[t+1]}\\
P_k[t]\approx 2 k s
\end{array}
\end{equation}

since $P$ is order $s$, which is small and assuming all $k$ alleles act independently.

\subsection*{Simulations}
Individual-based simulations were implemented in $\text{C}^{++}$ to test the behavior of our analytical model under relaxed assumptions. Unlike in our deterministic analysis, we include an explicit genetic map, assortative mating, varying recombination rates and diploidy in the simulations. Simulations track a population of $N_I$ invaders and $N_R$ residents, in which each individual carries a set of neutral loci (referred to as the background genome) of length $L$ and one selective locus referred to as $A$. We allow two alleles to segregate per locus (denoted '$+$' and '$-$'). 
	
At initialization, all loci (including the selective locus) are set according to the individual's type: $+$ for residents and $-$ for invaders. One generation involves the following successive stages: (1) assortative mating, (2) offspring production and (3) viability selection. The number of offspring in the next generation depends on the population fertility ($F$) and the current population size $N[t]$ by drawing from a Poisson distribution with rate parameter $N[t] F$. Each offspring is assigned two parents depending on an assortative mating parameter $M$. One parent is chosen at random and the other parent will be either random or assortative with probability $M$. There are two forms of assortative mating, either based on a random locus from the background genome or based on the selective locus ($A$). Subsequently, each offspring's genotype is determined by recombining the genotypes of both parents. Recombination occurs through successive Bernoulli trials at each locus. With probability $r$, a recombination event occurs between each pair of adjacent loci. Finally we allow $A_R$ alleles to mutate to $A_M$ alleles to account for rescue from within the resident population. Viability selection based on the selective locus determines if the offspring will survive to become a parent. Viability selection is implemented by comparing a random number from a uniform distribution to the individual's viability, which is determined by the selective locus ($A$) and includes a component of hybrid breakdown. Individuals that carry $A_I$ allele have a viability of $V_I (1 - 4 \omega q (1-q))$ to incorporate hybrid breakdown. $\omega$ represents the reduced fertility of having 50\% I alleles and 50\% of R alleles and $q$ represents the proportion of R alleles in the background genome. Individuals that carry $A_R$ have a viability of $V_R (1 - 4 \omega q (1-q))$. Each trial repeats this life-cycle for $G$ generations and each trial is repeated for $T$ trials. A successful trial of the simulation is determined by the fixation of the invader allele ($A_I$). One simulation involves $N_{trials}$ replicate trials. 

\section*{Appendix}

\subsection*{Recursion equations (2) of F}
\begin{center}
 \begin{tabular}{||c c c c c||} 
 \hline
 & wb & ww & bw & bb \\ [0.5ex] 
 \hline\hline
 F[t+1]&$\frac{1}{2} (F_w[t]+F_b[t])$  &$ F_w[t]$  & $\frac{1}{2} (F_w[t]+F_b[t])$  & $F_b[t] $ \\ 
 \hline
 Frequency & $\frac{N_b[t] }{N_b[t]  +N_w[t]}\frac{N_w[t]}{N_b[t] +N_w[t]}$ & $\frac{N_w[t]}{N_b[t] +N_w[t]}\frac{N_w[t]}{N_b[t] +N_w[t]}$ & $\frac{N_w[t]}{N_b[t] +N_w[t]}\frac{N_b[t] }{N_b[t]  +N_w[t]}$ & $\frac{N_b[t]}{N_b[t] +N_w[t]}\frac{N_b[t] }{N_b[t]  +N_w[t]}$ \\
 \hline
\end{tabular}
\end{center}

\begin{equation}
    \begin{array}{l}
    \text{by working out the interactions: }\\
    F_w[t+2] = \frac{1}{2}((\frac{1}{2} (F_w+F_b))+F_w)b w^3 + \frac{1}{2}((\frac{1}{2} (F_w+F_b))+(\frac{1}{2} (F_w+F_b)))b^2w^2+ \\ 
    \frac{1}{2}((\frac{1}{2} (F_w+F_b))+F_b)b^3w+ \frac{1}{2}((\frac{1}{2} (F_w+F_b))+(\frac{1}{2} (F_w+F_b)))b^2w^2 + \\
    \frac{1}{2}(F_w+(\frac{1}{2} (F_w+F_b)))bw^3+\frac{1}{2}(F_w+(\frac{1}{2} (F_w+F_b)))bw^3+\frac{1}{2}(F_w+F_b)b^2w^2+\frac{1}{2}(F_w+F_w)w^4 \\ \\
    F_w[t+2] = \frac{1}{4}w(F_w-3F_b(w-1)+3F_w w)
    \\ \\ \\ 
    
    \text{by induction:} \\
    F_w[t+2] = \frac{1}{2}(F_w[t+1]+F_b[t+1]) b + F_w[t+1] w \\
    F_w[t+2] = \frac{1}{2}((\frac{1}{2}(F_w+F_b) b + F_w w) + (\frac{1}{2}(F_w+F_b) w + F_b b)) b + \\ (\frac{1}{2}(F_w+F_b) b + F_w w) w \\ \\ 
    F_w[t+2] = \frac{1}{4}w(F_w-3F_b(w-1)+3F_w w)
    
    \end{array}
\end{equation}


\subsection*{Hitchhiking effect John-Maynard Smith}

The math in our model is very similar to the landmark paper by John-Maynard Smith and John Haigh (hereafter referred to as JMS) on the hitchiking effect of a neutral allele. \cite{JohnMarynardSmith1973}. JMS studied the effect of indirect selection through linkage on a single locus, and found a recursive equation for the hitchhiking effect. Here we provide a summary of their derivations and show how their model converges to ours.

Assume a randomly mating haploid population of intinite size with two loci, A and B. Two alleles segregate at each locus (0,1). Locus A is under directional selection, while locus B is considered neutral. Define A and B as two random variables where  $p[t] = P[A[t]=1]$, $Q[t] = P[B[t]=1|A[t]=1]$, $R[t] = P[B[t]=1|A[t]=0]$. This results in the following four genotype frequencies: $p[t]Q[t]$, $p[t](1-Q[t])$, $(1-p[t])(R[t])$ and $(1-p[t])(1-R[t])$

\begin{equation}
\begin{split}
    Q[t+1] = &Q[t]+ \frac{cR[0](1-p[0])(1-c)^t}{1-p[0]+p[0](1+s)^{t+1}} \\
             &Q[t]+ 2^{-t} \frac{\frac{1}{2}(1-p[0])}{1-p[0]+p[0](1+s)^{t+1}} \\
             &Q[t]+ 2^{-t} (1-p[t])
\end{split}
\end{equation}

$p[t] = \frac{1}{1+(\frac{1-p[0]}{p[0]}(1+s)^{-st}}$ \cite{Crow and Kimura An introduction to popluation}. Ans so

\begin{equation}
    Q[t] = \sum_{i=0}^t 2^{-i} p[i]
\end{equation}

We see that the dynamics of a single allele hitchhiking with a beneficial allele in an infinite population corresponds to the dynamics of introgression of infinite number of loci in a finite population.


\subsection*{Calculate selection differential}
\begin{equation}
    \begin{array}{l}
    \begin{split}
    p_b[t+1] &= \frac{N_b[t+1]}{N_b[t+1]+N_w[t+1]} \\
             &= \frac{W_bN_b[t]}{W_b N_b[t]+W_w N_w[t]} \\
             &= p_b[t]\frac{W_b}{W_b p_b[t]+W_wp_w[t]} \\
             &= p_b[t]\frac{\frac{W_b}{W_w}}{\frac{W_b}{W_w} p_b[t]+p_w[t]} \\
    \end{split}
    \end{array}
\end{equation}

\begin{equation}
    \begin{array}{l}
    \begin{split}
    1+s =\frac{W_b}{W_w} \\
    s = \frac{W_b}{W_w}-1
    \end{split}
    \end{array}
\end{equation}

\end{document}